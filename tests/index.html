<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>PyScript Next</title>
        <script>
            addEventListener("py:ready", console.log);
        </script>
        <link rel="stylesheet" href="https://pyscript.net/unstable/core.css">
        <script type="module" src="https://pyscript.net/unstable/core.js"></script>
        <script src="mini-coi.js"></script>
    </head>
    <body>
        <label for="Upload a File"></label>
        <input type="file" id="file-upload" mpy-change="upload_file_and_show">
        
        <script type="mpy">
            from js import document, window, Uint8Array

            async def upload_file_and_show(e):
                file_list = e.target.files
                first_item = file_list.item(0)

                my_bytes: bytes = await get_bytes_from_file(first_item)
                print(my_bytes[:10]) # Do something with file contents

            async def get_bytes_from_file(file):
                array_buf = await file.arrayBuffer()
                print(dir(array_buf))
                print(type(array_buf))
                return array_buf.to_bytes()

            #add_event_listener(document.getElementById("file-upload"), "change", upload_file_and_show)
        </script>
    </body>
</html>
